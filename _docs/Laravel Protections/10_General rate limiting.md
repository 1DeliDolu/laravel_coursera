# ğŸš¦ Genel hÄ±z sÄ±nÄ±rlamasÄ±

Bu kurs, Laravelâ€™de Rate limiting nasÄ±l uygulanÄ±r ve yapÄ±landÄ±rÄ±lÄ±r, bunu ele alÄ±yor. Bu videoda Rate limiting kavramÄ±nÄ± tanÄ±tacaÄŸÄ±m ve Laravelâ€™deki temel genel yapÄ±landÄ±rmalara bakacaÄŸÄ±z. O hÃ¢lde baÅŸlayalÄ±m ve Rate limitingâ€™in aslÄ±nda ne olduÄŸunu tanÄ±mlayalÄ±m. Rate limitingâ€™den bahsederken tam olarak neyi kastettiÄŸimizi anlamak Ã¶nemlidir. BÃ¶ylece neden rate limit uyguladÄ±ÄŸÄ±mÄ±zÄ± da anlayabiliriz. Bu iki kavrayÄ±ÅŸ birleÅŸtiÄŸinde ise en etkili rate limiting stratejisini seÃ§ebiliriz.

Rate limitingâ€™in ilk kÄ±smÄ± HTTP isteklerinin frekansÄ±nÄ± Ã¶lÃ§mektir. Bunlar web ziyaretÃ§ileri olabilir, API istekleri olabilir ya da buna benzer diÄŸer ÅŸeyler. Teknik olarak rate limiting komut satÄ±rÄ± araÃ§larÄ± iÃ§in bile yapÄ±landÄ±rÄ±labilir ama bu videonun kapsamÄ± dÄ±ÅŸÄ±nda. FrekansÄ± Ã¶lÃ§tÃ¼kten sonra limitsiz gelen isteklere sÄ±nÄ±r koyma zamanÄ± gelir. Yani ne kadar istek geldiÄŸini biliyoruz; peki bu tÃ¼r istekler iÃ§in izin verilen sÄ±nÄ±r nedir? Belirli bir zaman aralÄ±ÄŸÄ±nda maksimum kaÃ§ isteÄŸe izin vereceÄŸiz? En yaygÄ±n olarak, rate limit aÅŸÄ±ldÄ±ÄŸÄ±nda 429 HTTP hata kodu dÃ¶ndÃ¼rÃ¼lÃ¼r.

Bu, istemciye aÃ§Ä±k bir ÅŸekilde â€œhata durumundasÄ±n ve bu hÄ±zla ilgiliâ€ demenin bir yoludur. Ek bilgiler ek headerâ€™larla da gÃ¶nderilebilir: KaÃ§ istek yaptÄ±klarÄ±, tekrar ne zaman istek gÃ¶nderebilecekleri gibi. BazÄ± yaygÄ±n headerâ€™lar olsa da bunlar standart deÄŸildir. Rate limiting iÃ§in birÃ§ok araÃ§ mevcuttur. BazÄ± load balancer veya edge endpointâ€™lerde bu Ã¶zellik dahili olarak bulunur. BazÄ± web application firewall cihazlarÄ± ve sunucularÄ±nda da bu iÅŸlev gÃ¶mÃ¼lÃ¼dÃ¼r.

MÃ¼mkÃ¼n olduÄŸunda, Ã¶zellikle basit rate limit ihtiyaÃ§larÄ±nda, bu tÃ¼r araÃ§larÄ± kullanmayÄ± Laravel iÃ§inde bunu yapmaya tercih ediyorum. AmacÄ±mÄ±z tÃ¼m Laravel uygulamasÄ±nÄ± gereksiz yere ayaÄŸa kaldÄ±rmayÄ± engellemek. EÄŸer bunu Laravelâ€™e hiÃ§ dokunmadan Ã§Ã¶zebiliyorsanÄ±z, harika olur. Ancak daha karmaÅŸÄ±k senaryolar iÃ§in veya bu dÄ±ÅŸ araÃ§lara eriÅŸiminiz yoksa Laravelâ€™in dahili rate limiting mekanizmasÄ±nÄ± kullanabiliriz.

Rate limitingâ€™in ne olduÄŸunu bildiÄŸimize gÃ¶re, neden rate limit uyguladÄ±ÄŸÄ±mÄ±zdan bahsedelim. AmacÄ±mÄ±z uygulamaya cimrilik yapmak deÄŸil; bunun arkasÄ±nda geÃ§erli sebepler vardÄ±r. Ä°lk olarak, denial of service saldÄ±rÄ±larÄ±nÄ±n etkisini azaltmak isteriz. Bazen bir saldÄ±rgan uygulamaya ardÄ± ardÄ±na Ã§Ã¶p istekler gÃ¶ndererek siteyi bozmak isteyebilir. KullanÄ±cÄ±larÄ±mÄ±zÄ±n iyi bir deneyim yaÅŸamasÄ± iÃ§in bazÄ± ÅŸeyleri rate limit etmek isteriz.

EÄŸer ortalama bir kullanÄ±cÄ± dakikada bir-iki istek gÃ¶nderiyorsa fakat bir baÅŸka â€œziyaretÃ§iâ€ saniyede yÃ¼zlerce istek gÃ¶nderiyorsa bu genel kullanÄ±cÄ± deneyimini olumsuz etkiler, hatta sunucuyu boÄŸabilir. AÅŸÄ±rÄ± yÃ¼k altÄ±nda sunucular tuhaf davranÄ±ÅŸlar sergileyebilir; Ã¶rneÄŸin konfigÃ¼rasyon veya gizli bilgiler sÄ±zdÄ±ran hatalar. Yani sunucu uygun ÅŸekilde hazÄ±rlanmadÄ±ÄŸÄ± bir istek duvarÄ±yla karÅŸÄ±laÅŸÄ±nca ne yapacaÄŸÄ± belli olmaz.

AyrÄ±ca kaynaklarÄ±mÄ±zÄ± korumakla ilgilidir. Bu, basitÃ§e sÄ±nÄ±rlÄ± bir sunucumuz olduÄŸu anlamÄ±na gelebilir; dolayÄ±sÄ±yla tÃ¼m kullanÄ±cÄ±larÄ±n en azÄ±ndan kullanÄ±labilir bir site gÃ¶rmesini isteriz. Ya da â€œpay as you goâ€ modeliyle Ã§alÄ±ÅŸan bir yapÄ±dayÄ±zdÄ±r ve bÃ¼tÃ§emiz sÄ±nÄ±rlar. Hatta sÄ±nÄ±rlÄ± stok iÃ§eren bir sistemimiz olabilir ve en hÄ±zlÄ± spam gÃ¶nderenlerin tÃ¼m stoklarÄ± Ã§ekmesini engellemek isteriz.

Laravel dahili bir rate limiting mekanizmasÄ± saÄŸlar. Bu mekanizma, genel rate limiting sunar: belirli bir endpointâ€™e gelen istekleri takip eder ve belirlenen zaman aralÄ±ÄŸÄ±nda belirlenen miktarÄ± aÅŸarsa sÄ±nÄ±r koyar. Laravel ayrÄ±ca segmented ve conditional rate limiting seÃ§enekleri de sunar. Bunlar genel rate limitingâ€™in daha akÄ±llÄ± hÃ¢lleridir; gelen isteÄŸin kendi verilerine veya durumuna baÄŸlÄ± olarak limit uygular. BunlarÄ± bir sonraki videoda ele alacaÄŸÄ±z. Bu yapÄ± genellikle RouteServiceProvider iÃ§inde yapÄ±landÄ±rÄ±lÄ±r.

ArdÄ±ndan throttle middlewareâ€™i ile web.php gibi route tanÄ±mlarÄ±nda uygulanÄ±r. Åimdi RouteServiceProvider iÃ§inde birkaÃ§ rate limit tanÄ±mÄ±na bakalÄ±m. Kod biraz kÄ±saltÄ±lmÄ±ÅŸ olsa da configureRateLimiting fonksiyonuna odaklanÄ±rsanÄ±z iki farklÄ± rate limit tanÄ±mladÄ±ÄŸÄ±mÄ± gÃ¶rÃ¼rsÃ¼nÃ¼z. RateLimiter sÄ±nÄ±fÄ±nÄ±n for metodunu kullanÄ±yoruz. Ä°ki parametre vermelisiniz: Ä°lk parametre rate limiterâ€™Ä±n adÄ±dÄ±r; istediÄŸiniz bir isim olabilir ama ne iÃ§in kullanÄ±ldÄ±ÄŸÄ±nÄ± Ã§aÄŸrÄ±ÅŸtÄ±racak bir isim vermenizi Ã¶neririm. Ä°kinci parametre ise bir closureâ€™dÄ±r ve bir Limit sÄ±nÄ±fÄ±nÄ±n instanceâ€™Ä±nÄ± dÃ¶ndÃ¼rmelidir.

Ä°lk tanÄ±ma bakalÄ±m. Bu bir global rate limit. Herhangi bir endpointâ€™e dakikada 1000 isteÄŸe kadar izin vermek istiyorum. Ã‡oÄŸu kiÅŸi rate limitleri dakikaya gÃ¶re tanÄ±mlar â€” oldukÃ§a basittir.

Åimdi Ã¼Ã§Ã¼ncÃ¼ parti bir sistemin bize dakikada bir kez Ã§aÄŸÄ±rdÄ±ÄŸÄ± bir webhooks setimiz olduÄŸunu dÃ¼ÅŸÃ¼nelim. Bu Ã§aÄŸrÄ±larÄ± tam olarak 60 adet ile sÄ±nÄ±rlamak istemem Ã§Ã¼nkÃ¼ saat kaymasÄ± veya kÃ¼Ã§Ã¼k hatalar nedeniyle istemeden kendi kendilerini kilitleyebilirler. Yine de bir hatayla sÃ¼rekli webhook gÃ¶ndermeye baÅŸlamalarÄ± ihtimaline karÅŸÄ± limit koymak isterim. Bu yÃ¼zden beklenen isteÄŸin iki katÄ± olan 120 deÄŸerini seÃ§ip bunu saatlik limit olarak tanÄ±mladÄ±m.

Peki bunlarÄ± nasÄ±l uygularÄ±z? Burada webhooks prefixâ€™i altÄ±nda bir route group oluÅŸturdum. ArdÄ±ndan throttle middlewareâ€™ini webhook adÄ±yla bu gruba uyguladÄ±m. BÃ¶ylece webhook/new-product gibi endpointâ€™ler saatlik 120 istekle sÄ±nÄ±rlandÄ±rÄ±lacaktÄ±r.

Bu elbette rate limit yapÄ±landÄ±rmasÄ±nÄ±n oldukÃ§a basit bir hÃ¢li. Peki kullanÄ±cÄ±ya gÃ¶re, tokenâ€™a gÃ¶re, IPâ€™ye gÃ¶re limit koymak istersek? Bir sonraki videoda daha karmaÅŸÄ±k Rate Limiter yapÄ±landÄ±rmalarÄ±nÄ± ele alacaÄŸÄ±z.
